#!/usr/bin/env ruby

require 'optparse'
require 'methadone'
require File.dirname(__FILE__) + '/../lib/gitloop'

include Methadone::Main

main do |from_ref, to_ref|
  begin
    Gitloop::Looper.make_loop_for_references_or_messages(from_ref, to_ref, options[:message])
  rescue Gitloop::GitError => e
    puts "*** ERROR : #{e}"
  end
end


description "combine `git merge --no--ff ..` and `git rebase ..` to regroup commits in a loop"

opts.on("-m MESSAGE","--message", "custom merge message" ) do |message|
  options[:message] = message
end

arg :message


version Gitloop::VERSION

go!
